<% @page_title = "All Events" %>
<div class = "books index">
	<h2>Events</h2>
	<% if user_signed_in? %>
	<%= link_to(image_tag('plus_sign.png', :size => '11x11', :alt => '+') + " Add New Event", {:action => 'new'}, :class => 'action new') %>
	<% end %>
	
	<table class="listing" summary="Event list">
		<tr class="header">			
			<th>Name</th>
			<th>Venue</th>
			<th>City</th>
			<th>Number of Spaces</th>
			<th>Organiser</th>
			<th>Actions</th>
		</tr>
		<% @events.each do |event| %>
		<tr class="<%= cycle('odd', 'even') %>">
			<td><%= event.name %></td>
			<td><%= event.venue %></td>
			<td><%= event.city %></td>
			<td><%= event.no_of_available_seats %></td>
			<% unless event.created_by == 0 || event.created_by == nil %>
				<td><%= @users.find(event.created_by).name %></td>
			<% else %>
				<td></td>	
			<% end %>					
			<td class="actions">
				<%= link_to("Show", event_path(event.id), :class => 'btn btn-primary btn-sm') %>
				<% if current_user.nil? %>
				<% else %>
				<% if current_user.id == event.created_by || current_user.try(:admin?) %>
					<%= link_to("Edit", edit_event_path(event.id), :class => 'btn btn-info btn-sm') %>				 			
				<% end %>
				<% if current_user.id == event.created_by || current_user.try(:admin?) %>
					<%= link_to("Delete", delete_event_path(event.id), :class => 'btn btn-warning btn-sm') %>
				<% end %>
				<% end %>
			</td>
		</tr>
		<% end %>
	</table>
</div>
