<% @page_title = @event.name %>
<%= link_to("<< Back to Event Listing", events_path, :class => 'back-link') %>
<div class="container">
	<h2 class="centered"><%= @event.name %></h2>
	<% if user_signed_in? %>
		<% if @event.users.include?current_user %>
			<h4 class="alert-notice centered">You are registered for this event</h4>
			<%= link_to("De-register for the Event", {:action => 'miss', :id => @event.id}, :class => 'btn-sm btn-primary text-center') %>	
		<% else %>
			<%= link_to("Register for Event", {:action => 'attend', :id => @event.id}, :class => 'btn-sm btn-primary text-center') %>	
			
		<% end %>

	<% end %></div>
	<div class="container">
		<div class="row">		
			<div class="col-sm-4"><strong>Venue</strong></div>
			<div class="col-sm-8"><%= @event.venue %></div>
		</div>
		<br />
		<div class="row">		
			<div class="col-sm-4"><strong>Town/City</strong></div>
			<div class="col-sm-8"><%= @event.city %></div>
		</div>
		<br />
		<div class="row">		
			<div class="col-sm-4"><strong>Number of Spaces</strong></div>
			<div class="col-sm-8"><%= @event.no_of_available_seats %></div>
		</div>			
		<br />
		<div class="row">		
			<div class="col-sm-4"><strong>Number of People registered</strong></div>
			<div class="col-sm-8"><%= @event.users.size %></div>
		</div>			
		<br />
		<div class="row">		
			<div class="col-sm-4"><strong>Event Description</strong></div>
			<div class="col-sm-8"><%= @event.description %></div>
		</div>
		<br />	
		<% unless @event.avatar_url == nil  %>			
		<div class="row">		
			<div class="col-sm-4 centered"><!-- <strong>Flyer</strong> --></div>
			<div class="col-sm-8"> <%= link_to image_url(@event.avatar_url(:normal)) do %>
				<%= image_tag @event.avatar_url(:thumb) %>
				<% end %>
			</div>
		</div>
		<% end %>
		<br />
		<% unless @event.created_by == 0 || @event.created_by == nil  %>		
		<div class="row">		
			<div class="col-sm-4 centered"><strong>Created by</strong></div>
			<div class="col-sm-8"><strong><%= @users.find(@event.created_by).name %></strong></div>
		</div>				
		<% end %>
	</div>	
</div>


<hr />

<div class="container">
<h4>Comments about "<%= @event.name %>"</h4>
<% if @event.comments.empty? %>
		<td> There are no comments on this event. Why not write yours? </td>
<% else %>
	<td><% @event.comments.each do |comment| %>
	<%= comment.comment %>, by <%= find_user(comment.user_id) %>
	<% end %></td>
<% end %>
<!-- Button trigger modal -->
<button class="btn btn-success btn-xs" data-toggle="modal" data-target="#approvalModal">
 Add Comment
</button> <%= link_to("Add Comments", {:controller => 'comments', :action => 'new'}) %>


<div class="example gc3">
    <h3>Modal popup</h3>
    <p>A modal popup disables the usual ways to close popups.</p>
    <div class="html-code">
      <a class="popup-modal" href="#test-modal">Open modal</a>

      <div id="test-modal" class="mfp-hide white-popup-block">
        <h1>Modal dialog</h1>
        <p>You won't be able to dismiss this by usual means (escape or
          click button), but you can close it programatically based on
          user choices or actions.</p>
        <p><a class="popup-modal-dismiss" href="#">Dismiss</a></p>
      </div>
    </div>
    <script type="text/javascript">
      $(function () {
        $('.popup-modal').magnificPopup({
          type: 'inline',
          preloader: false,
          focus: '#username',
          modal: true
        });
        $(document).on('click', '.popup-modal-dismiss', function (e) {
          e.preventDefault();
          $.magnificPopup.close();
        });
      });
    </script>
  </div>


</div>
<br />
<br />
<br />

<!-- Modal -->
<div class="modal fade" id="approvalModal" tabindex="-1" role="dialog" aria-labelledby="approvalModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title">Approval</h4>
      </div>
      <div class="modal-body">
        <%= form_tag(:controller => 'comments', :action => 'create', method: :get, :class => "form-horizontal") do %>
              <%= label_tag 'reason', 'Reason for Approval', :class => 'control-label' %>
              <%= text_field_tag :reason, params[:reason], :class => "form-control" %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
           <%= submit_tag "Submit Approval", name: nil, class: "btn btn-success" %>
        <% end %>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->